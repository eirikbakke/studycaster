<?xml version="1.0" encoding="UTF-8"?>
<study xmlns="namespace://ebakke.no/studycaster-configuration">
  <!-- TODO: Document this configuration file format. -->
  <macrodef id="uistrings-english">
    <uistrings>
      <uistring key="DIALOG_CONSENT_TITLE">Screencasting</uistring>
      <uistring key="DIALOG_CONSENT_QUESTION"><html xmlns="">
        This tool will record the contents of your screen while you perform the HIT,<br/>
        so we can learn about how different people approached the task.<br/><br/>
        OK to start recording?</html>
      </uistring>
      <uistring key="DIALOG_ALREADY_RUNNING_TITLE">Already Running</uistring>
      <uistring key="DIALOG_ALREADY_RUNNING_MESSAGE">
        <html xmlns="">The StudyCaster client is already running in a different window.<br/>
                       Please close it first if you wish to start over.</html>
      </uistring>
      <uistring key="MAINFRAME_OPEN_FILE_BUTTON"  mnemonic="D">Open Sample Document...</uistring>
      <uistring key="MAINFRAME_OPEN_URI_BUTTON"   mnemonic="W">Open Sample Web Page...</uistring>
      <uistring key="MAINFRAME_CONCLUDE_BUTTON"   mnemonic="C">Upload and Retrive Confirmation Code...</uistring>
      <uistring key="MAINFRAME_BACK_BUTTON"       mnemonic="B">&lt; Back</uistring>
      <uistring key="MAINFRAME_NEXT_BUTTON"       mnemonic="N">Next &gt;</uistring>
      <uistring key="DIALOG_CLOSE_TITLE"  >Exit Without Uploading?</uistring>
      <uistring key="DIALOG_CLOSE_MESSAGE">
        If you exit the StudyCaster client without uploading first, your changes will be lost.
      </uistring>
      <uistring key="PROGRESS_OPEN_FILE">Opening file...</uistring>
      <uistring key="PROGRESS_OPEN_URI">Opening web page...</uistring>
      <uistring key="PROGRESS_UPLOAD_FILE">Uploading file...</uistring>
      <uistring key="PROGRESS_UPLOAD_SCREENCAST">Finishing screencast upload...</uistring>

      <uistring key="DIALOG_OPEN_FILE_TITLE">Open Sample Document</uistring>
      <uistring key="DIALOG_OPEN_FILE_EXISTING_MESSAGE"><html xmlns="">
        The StudyCaster client found a modified file from an old session:<br/>
        {0}<br/><br/>
        Would you like to keep working on the existing file, or download a new one?</html>
      </uistring>
      <uistring key="DIALOG_OPEN_FILE_MODIFIED_MESSAGE"><html xmlns="">
        The file was previously opened and modified:<br/>
        {0}<br/><br/>
        Would you like to keep working on the existing file, or download a new one?</html>
      </uistring>
      <uistring key="DIALOG_OPEN_FILE_RENAMED_MESSAGE"><html xmlns="">
        The old file<br/>
        {0}<br/>
        was renamed to<br/>
        {1}</html>
      </uistring>
      <uistring key="DIALOG_OPEN_FILE_RENAME_FAILED_MESSAGE"><html xmlns="">
        Failed to rename the file<br/>
        {0}<br/><br/>
        If the file is still open, please close it and try again.</html>
      </uistring>
      <!-- The message below is shown on a best-effort basis, currently never on JRE 1.5. The second
      message parameter is a string from the <errormessage> element in the <openfile> configuration.
      -->
      <uistring key="DIALOG_OPEN_FILE_ASSOCIATION_FAILED_MESSAGE"><html xmlns="">
        Failed to open the file<br/>{0}<br/><br/>
        {1}</html>
      </uistring>
      <!-- The message below is shown on a best-effort basis; it is not always possible to detect
      whether a file is already open in a different program. -->
      <uistring key="DIALOG_OPEN_FILE_ALREADY_MESSAGE"><html xmlns="">
        The file already appears to be open:<br/>
        {0}<br/><br/>
        The file should have opened in a new window, possibly in the background.</html>
      </uistring>
      <uistring key="DIALOG_OPEN_FILE_NEW_BUTTON">Download New File</uistring>
      <uistring key="DIALOG_OPEN_FILE_KEEP_BUTTON">Keep Existing File</uistring>
      <uistring key="DIALOG_CONCLUDE_TITLE">Upload and Retrieve Confirmation Code</uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_PATH_LABEL" mnemonic="F">File to upload:</uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_INFO_LABEL">
        If you saved the file to a different location, select the new location here. Otherwise, just click OK.
      </uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_BROWSE_BUTTON" mnemonic="B">Browse...</uistring>
      <uistring key="DIALOG_CONCLUDE_QUESTION">
        OK to conclude study and retrieve a confirmation code?
      </uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_NOT_OPENED_MESSAGE">
        To upload an edited file, please open it first using the "Open Sample Document" button.
      </uistring>
      <uistring key="DIALOG_CONCLUDE_EMPTY_PATH_MESSAGE">
        Please select a file to upload.
      </uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_NOT_EXISTS_MESSAGE"><html xmlns="">
        The file does not exist:<br/>
        {0}</html>
      </uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_OPEN_MESSAGE"><html xmlns="">
        Please close the file, then try again.<br/>
        {0}</html>
      </uistring>
      <uistring key="DIALOG_CONCLUDE_FILE_NOT_MODIFIED_MESSAGE"><html xmlns="">
        Please edit, save, and close the file before uploading it:<br/>
        {0}<br/><br/>
        If necessary, open the file again using the "Open Sample Document" button.</html>
      </uistring>
      <uistring key="DIALOG_CONFIRMATION_TITLE">Upload Successful</uistring>
      <uistring key="DIALOG_CONFIRMATION_CODEBOX_LABEL" mnemonic="U">
        Upload Successful! Your confirmation code is...
      </uistring>
      <uistring key="DIALOG_CONFIRMATION_CLIPBOARD_MESSAGE">
        (The code has been copied to the clipboard so you can paste it into the HIT.)
      </uistring>

    </uistrings>
  </macrodef>
  <!-- Foreign language example, to test UI string settings. -->
  <macrodef id="uistrings-norwegian">
    <uistrings>
      <uistring key="DIALOG_ALREADY_RUNNING_TITLE">Allerede åpnet</uistring>
      <uistring key="DIALOG_ALREADY_RUNNING_MESSAGE">
        <html xmlns="">StudyCaster-klienten kjører allerede i et annet vindu.<br/>
                       Vennligst lukk det gamle vinduet først dersom du vil begynne på nytt.</html>
      </uistring>
      <uistring key="MAINFRAME_OPEN_FILE_BUTTON" mnemonic="Å">Åpne eksempeldokument...</uistring>
      <uistring key="MAINFRAME_CONCLUDE_BUTTON" mnemonic="L">Last opp og motta bekreftelseskode...</uistring>
      <uistring key="MAINFRAME_BACK_BUTTON"     mnemonic="T">&lt; Tilbake</uistring>
      <uistring key="MAINFRAME_NEXT_BUTTON"     mnemonic="N">Neste &gt;</uistring>
      <uistring key="DIALOG_CLOSE_TITLE"  >Avslutt uten å laste opp?</uistring>
      <uistring key="DIALOG_CLOSE_MESSAGE">
        Hvis du avslutter StudyCaster uten å laste opp først, går endringene dine tapt.
      </uistring>
      <uistring key="PROGRESS_OPEN">Åpner fil...</uistring>
      <!-- TODO: Translate remaining strings. -->
    </uistrings>
  </macrodef>

  <macrodef id="instructions">
    <instructions>
      <html xmlns="">
        <b>Instructions:</b>
        <ol>
          <li>Edit the spreadsheet that opened in another window<br/>
              (according to the instructions in the HIT).</li>
          <li>Save and close the spreadsheet</li>
          <li>Click the button below.</li>
          <li>Paste the confirmation code into the HIT.</li>
        </ol>
        <p align="right">
          Thanks!<br/>
          <a href="mailto:ebakke@mit.edu">ebakke@mit.edu</a>
        </p>
      </html>
    </instructions>
  </macrodef>

  <macrodef id="configuration-common">
    <screencast>
      <whitelist>Excel</whitelist>
      <whitelist>Calc</whitelist>
      <whitelist>Numbers</whitelist>
      <whitelist>Gnumeric</whitelist>
      <whitelist>KSpread</whitelist>
      <whitelist>Quattro</whitelist>
      <whitelist>Mesa</whitelist>
      <whitelist>Spreadsheet Study Application</whitelist>
      <blacklist>Firefox</blacklist>
      <blacklist>Internet Explorer</blacklist>
      <blacklist>Chrome</blacklist>
      <blacklist>Safari</blacklist>
      <blacklist>Opera</blacklist>
      <blacklist>Thunderbird</blacklist>
      <blacklist>Outlook</blacklist>
    </screencast>
    <macro id="uistrings-english"/>
  </macrodef>

  <macrodef id="filefilter-excel">
    <filefilter>
      <description>Microsoft Excel Workbook</description>
      <extension>xls</extension>
      <extension>xml</extension>
      <extension>xlsx</extension>
      <extension>xlsm</extension>
      <extension>xlsb</extension>
    </filefilter>
  </macrodef>

  <macrodef id="filefilter-relspread">
    <filefilter>
      <description>Spreadsheet Study Application files</description>
      <extension>rzw</extension>
    </filefilter>
  </macrodef>

  <macrodef id="openfile-error-excel">
    Do you have Excel or a compatible spreadsheet application installed?
  </macrodef>
  <macrodef id="upload-unchanged">
    <html xmlns="">Please edit, save, and close the file, then try again.<br/><br/>
                   The file should have opened in a new window, possibly in the background.</html>
  </macrodef>

  <configuration id="default" name="Recruiting">
    <macro id="configuration-common"/>
    <page>
      <instructions>
        <html xmlns="">
          This is the first page.
        </html>
      </instructions>
    </page>

    <page>
      <instructions>
        <html xmlns="">
          This is the second page. It has an open file button, and an open URI
          button.<br/><br/>
          This is a second paragraph (actually, just after some BR tags).
        </html>
      </instructions>
      <openfile> <!-- Optional -->
        <servername>testfile.pdf</servername>
        <clientname>StudyCaster testfile with spaces in name.pdf</clientname>
        <errormessage>Do you have a program that can open PDF files
                      (e.g. Acrobat Reader) installed?</errormessage>
      </openfile>
      <openuri> <!-- Optional -->
        <uri>http://www.youtube.com/watch?v=dQw4w9WgXcQ</uri>
      </openuri>
    </page>

<!--
    <page>
      <instructions><html xmlns="">
        This is another page. This one demonstrates the use of an HTML table.<br/><br/>
        <table border="1">
        <thead>
        <tr><td colspan="5"></td><td colspan="4">Custom Connector</td></tr>
        <tr><td colspan="7">Digilent JTAG3 L-C JTAG D/D Cable</td><td colspan="4">S3 Starter Kit Board</td></tr>
        <tr><th colspan="5">Parallel port</th><th colspan="2">JTAG</th><th colspan="2">B1 Exp. port</th><th colspan="2">FPGA Pins</th></tr>	
        <tr><th>Pin</th><th>Name</th><th>Register</th><th>Inv?</th><th>Direction</th><th>Pin</th><th>Name</th><th>Pin</th><th>Name</th><th>Pin</th><th>Name</th></tr>
        </thead>
        <tbody>
        <tr><td>4</td><td>Data 2</td><td>Data</td><td>No</td><td><code>-&gt;</code></td><td>1</td><td><code>TMS</code></td><td>4</td><td><code>PB-ADR0</code></td><td><code>C10</code></td><td><code>IO3</code></td></tr>
        <tr><td>2</td><td>Data 0</td><td>Data</td><td>No</td><td><code>-&gt;</code></td><td>2</td><td><code>tdI</code></td><td>6</td><td><code>PB-ADR1</code></td><td><code>E10</code></td><td><code>l30P_1</code></td></tr>
        <tr><td>13</td><td>Select</td><td>Status</td><td>No</td><td><code>&lt;-</code></td><td>3</td><td><code>tdO</code></td><td>8</td><td><code>PB-ADR2</code></td><td><code>C11</code></td><td><code>L29P_1</code></td></tr>
        <tr><td>3</td><td>Data 1</td><td>Data</td><td>No</td><td><code>-&gt;</code></td><td>4</td><td><code>TCK</code></td><td>10</td><td><code>PB-ADR3</code></td><td><code>D11</code></td><td><code>L28N_1</code></td></tr>
        <tr><td>18</td><td>GND</td><td></td><td></td><td><code>-</code></td><td>5</td><td><code>GND</code></td><td>1</td><td><code>GND</code></td></tr>
        <tr><td></td><td></td><td></td><td></td><td></td><td>6</td><td><code>VCC</code></td><td>3</td><td><code>Vcco</code> (3.3V)</td></tr>
        <tr><td>9</td><td>Data 7 (6?)</td><td>Data</td><td>No</td><td><code>-&gt;</code>|</td><td></td></tr>
        <tr><td>11</td><td>Busy</td><td>Status</td><td>Yes</td><td><code>&lt;-</code>|</td><td></td></tr>
        <tr><td>12</td><td>Paper-Out</td><td>Status</td><td>No</td><td><code>&lt;-</code>|</td><td></td></tr>
        </tbody>
        </table>
      </html></instructions>
    </page>
-->

    <page>
      <instructions>
        <html xmlns="">
          <base href="http://www.mit.edu/~ebakke/" />
          This is the third page. It has a conclude study button, with no upload.<br/>
          <br/>
          <center>
          <img src="meet/limecat.jpg" alt="limecat" border="1" />
          </center>
        </html>
      </instructions>
      <conclude> <!-- Optional -->
      </conclude>
    </page>

    <page>
      <macro id="instructions"/>
      <openfile> <!-- Optional -->
        <servername>currencies.xls</servername>
        <clientname>userstudyHIT_currencies.xls</clientname>
        <errormessage><macro id="openfile-error-excel"/></errormessage>
      </openfile>
      <conclude> <!-- Optional -->
        <uploadfile> <!-- Optional -->
          <macro id="filefilter-excel"/>
          <default>userstudyHIT_currencies.xls</default> <!-- Optional -->
          <unchangedwarning><macro id="upload-unchanged"/></unchangedwarning> <!-- Optional -->
        </uploadfile>
      </conclude>
    </page>
  </configuration>

  <configuration id="6728" name="Main Excel">
    <macro id="configuration-common"/>
    <page>
      <macro id="instructions"/>
      <openfile>
        <servername>exflat.xls</servername>
        <clientname>userstudyHIT_coursecatalog.xls</clientname>
        <errormessage><macro id="openfile-error-excel"/></errormessage>
      </openfile>
      <conclude>
        <uploadfile>
          <macro id="filefilter-excel"/>
          <default>userstudyHIT_coursecatalog.xls</default>
          <unchangedwarning><macro id="upload-unchanged"/></unchangedwarning>
        </uploadfile>
      </conclude>
    </page>
  </configuration>

  <configuration id="1093" name="Main Related Worksheets">
    <macro id="configuration-common"/>
    <page>
      <macro id="instructions"/>
      <openfile>
        <servername>rsnest.rzw</servername>
        <clientname>userstudyHIT_coursecatalog.rzw</clientname>
        <errormessage>Unexpected error.</errormessage>
      </openfile>
      <conclude>
        <uploadfile>
          <macro id="filefilter-relspread"/>
          <default>userstudyHIT_coursecatalog.rzw</default>
          <unchangedwarning><macro id="upload-unchanged"/></unchangedwarning>
        </uploadfile>
      </conclude>
    </page>
  </configuration>
</study>

